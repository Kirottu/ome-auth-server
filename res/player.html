<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kirottu's streaming den</title>
  <link rel="icon" href="/harold.png">

  <style>
    #buttons {
      display: flex;
      column-gap: 10px;
      padding-bottom: 20px;
    }
  </style>

  <script src="https://unpkg.com/htmx.org@1.9.4"></script>
  <!-- Load OvenPlayer via CDN -->
  <script src="https://cdn.jsdelivr.net/npm/ovenplayer/dist/ovenplayer.js"></script>
</head>

<body>

  <h1>Kirottu's streaming den</h1>
  <p>
    Select a stream to watch.<br>
    <b>NOTE: You will need to be accepted to watch, so wait patiently and notify the streamer.</b>
  </p>

  <h4>Available streams</h4>

  <div id="buttons" hx-get="/streams" hx-trigger="load, every 1s">
  </div>

  <div id="player_wrapper">
    <!-- OvenPlayer will be initialized inside this element. -->
    <div id="player_id"></div>

  </div>

  <script>
    var player = null;
    // Initialize OvenPlayer
    function create_player(stream) {
      if (player != null) {
        player.remove();
      }

      player = OvenPlayer.create('player_id', {
        sources: [
          {
            label: 'label_for_webrtc',
            // Set the type to 'webrtc'
            type: 'webrtc',
            // Set the file to WebRTC Signaling URL with OvenMediaEngine 
            file: 'wss://{host}:3334/app/' + stream,
          }
        ],
        timeout: 600000,
      });
    }
  </script>
</body>

</html>